<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.5">Jekyll</generator><link href="http://localhost:4000/atom.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2019-05-09T11:35:35+08:00</updated><id>http://localhost:4000/</id><title type="html">Guangyu Corey Shan’s Blog</title><subtitle>Notes on bioinformatics and data mining by G. Corey Shan</subtitle><author><name>Corey</name></author><entry><title type="html">28% prediction accuracy for neoantigens</title><link href="http://localhost:4000/articles/low-accuracy-of-neoantigen-prediction.tmp/" rel="alternate" type="text/html" title="28% prediction accuracy for neoantigens" /><published>2019-05-08T00:00:00+08:00</published><updated>2019-05-08T00:00:00+08:00</updated><id>http://localhost:4000/articles/low-accuracy-of-neoantigen-prediction.tmp</id><content type="html" xml:base="http://localhost:4000/articles/low-accuracy-of-neoantigen-prediction.tmp/">&lt;p&gt;Cancer immunotherapy field is all the rage and neoantigen is the pearl of this field, but &lt;em&gt;in silico&lt;/em&gt; neoantigen prediction remains a daunting probe&lt;/p&gt;

&lt;p&gt;Cancer immunotherapy field&lt;/p&gt;

&lt;p&gt;Several days ago, I searched the prediction accuracy information by chance and found some companies claim their neoantigen prediction accuracy has already surpassed 60%, which is far more greater than the current 28% affinity-based theoretical boundary, which is presented by Catherine J. Wu, MD&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://shangyblog-1256840873.cos.ap-beijing.myqcloud.com/neo-accuracy.png&quot; alt=&quot;image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Targeting an individual’ tumor-specific mutations is attractive because these peptides are new to the immune system and are not found in normal tissues. The key question for neoepitope discovery is which mutated proteins are processed into 8 to 11 residue peptides by the proteasome, shuttled into endoplasmic reticulum by the transporter associated with antigen processing (TAP) and loaded onto newly synthesized major histocompatibility complex class I (MHC-I) for recognition by CD8&lt;sup&gt;+&lt;/sup&gt; T cells. Although Current &lt;em&gt;in silico&lt;/em&gt; methods for identifying neoantigen are focused on different areas like anrtigen processing (NetChop) and peptide transport (NetCTL), most efforts focus on modeling which peptides bind to the MHC-I molecule (NetMHC). And to what I have known, most mainstream NGS companies in China are place NetMHC on the top of their priority list.&lt;/p&gt;

&lt;p&gt;NetMHC is based on infinity and the theoretical accuracy boundary is 28%. In other word, for now, computational prediction of neoantigens capable of eliciting efficacious antitumor responses in patients remains a hit-or-miss affair.&lt;/p&gt;

&lt;p&gt;It is exactly of this problem, the companies which do not want to .&lt;/p&gt;

&lt;p&gt;To improve the prediction accuracy:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;High quality mass spectrometry data&lt;/li&gt;
  &lt;li&gt;ok&lt;/li&gt;
  &lt;li&gt;man&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Abelin J G, Keskin D B, Sarkizova S, et al. Mass spectrometry profiling of HLA-associated peptidomes in mono-allelic cells enables more accurate epitope prediction[J]. Immunity, 2017, 46(2): 315-326. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Corey</name></author><category term="Bioinformatics" /><category term="Neoantigens" /><summary type="html">poor accuracy brings us TNB</summary></entry><entry><title type="html">SELL【igenel.com】</title><link href="http://localhost:4000/articles/sell-domain-igenel.com/" rel="alternate" type="text/html" title="SELL【igenel.com】" /><published>2019-01-23T00:00:00+08:00</published><updated>2019-01-23T00:00:00+08:00</updated><id>http://localhost:4000/articles/sell-domain-igenel.com</id><content type="html" xml:base="http://localhost:4000/articles/sell-domain-igenel.com/">&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;igenel.com&lt;/code&gt; is a website domain which is suitable for opening up biology business. If there is a predestined guy willing to buy this domain, please do not hesitate to contact &lt;a href=&quot;mailto:me@shanguangyu.com&quot;&gt;me&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Corey @ 2019-01-23 17:53:42 UTC+0800&lt;/p&gt;</content><author><name>Corey</name></author><category term="Business" /><summary type="html">Domain for genomics business</summary></entry><entry><title type="html">Why are we looking forward to the new year</title><link href="http://localhost:4000/articles/why-are-we-looking-forward-to-the-new-year/" rel="alternate" type="text/html" title="Why are we looking forward to the new year" /><published>2018-12-29T00:00:00+08:00</published><updated>2018-12-29T00:00:00+08:00</updated><id>http://localhost:4000/articles/why-are-we-looking-forward-to-the-new-year</id><content type="html" xml:base="http://localhost:4000/articles/why-are-we-looking-forward-to-the-new-year/">&lt;p&gt;Today is the last statutory working day, and I feel somewhat happy because the new year is waving hands to me. But I did not think about why I love the new year. After several seconds thought, I guess the choice opportunity is the main reason that I like the new year.&lt;/p&gt;

&lt;p&gt;The so-called new year is always connected with the past year. In the past year, we may get achievements in some aspects, like learned new skills and get a better body. No matter what we have got in our pocket, our mind will never be satisfied with the current situation. However, the new year is a brand new, fresh page in our life, and the most critical part is the precious opportunity for us to make up for the regrets.&lt;/p&gt;

&lt;p&gt;Choice opportunity is precious, and we can not get enough choices if we do not discipline ourselves. But the new year gives us an illusion that we can choose what to improve in the future. Although it is an illusion, our people still want to trust it because we prefer to good news rather than the bad news. Nevertheless, bad news will happen someday, and we need prepare for the worst and discipline ourself for the best.&lt;/p&gt;

&lt;p&gt;In the new year, hope we can take advantage of the choice opportunity to embrace the adventure of the new year. After all, lazy away do not create memories. Adventures do.&lt;/p&gt;</content><author><name>Corey</name></author><category term="Life" /><summary type="html">Happy new year</summary></entry><entry><title type="html">Dangerous move: create gene-edited babies</title><link href="http://localhost:4000/articles/dangerous-move-create-gene-edited-babies/" rel="alternate" type="text/html" title="Dangerous move: create gene-edited babies" /><published>2018-11-28T00:00:00+08:00</published><updated>2018-11-28T00:00:00+08:00</updated><id>http://localhost:4000/articles/dangerous-move-create-gene-edited-babies</id><content type="html" xml:base="http://localhost:4000/articles/dangerous-move-create-gene-edited-babies/">&lt;p&gt;Since &lt;a href=&quot;https://en.wikipedia.org/wiki/CRISPR&quot;&gt;CRISPR&lt;/a&gt; technology has come into the world, the community began to worry about the &lt;a href=&quot;https://en.wikipedia.org/wiki/Deep_Blue_Sea_(1999_film)&quot;&gt;mako sharks&lt;/a&gt; will jump out of the science fiction into the real world someday. It is not a very difficult experiment, and many labs have experimental conditions and talents to perform it. No one kicks the door is because of the hidden ethics problems until three days ago.&lt;/p&gt;

&lt;p&gt;As first reported by &lt;a href=&quot;https://www.technologyreview.com/s/612458/exclusive-chinese-scientists-are-creating-crispr-babies/&quot;&gt;Antonio Regalado at MIT Technology Review&lt;/a&gt;. The Chinese scientist Jiankui He has stated the birth of two human girls, &lt;a href=&quot;https://en.wikipedia.org/wiki/Lulu_and_Nana&quot;&gt;Lulu and Nana&lt;/a&gt;, as the world’s first CRISPR-edited babies. The Human genes were edited to resist the HIV. This technology move brings great &lt;a href=&quot;https://www.theguardian.com/science/2018/nov/27/he-jiankui-chinese-gene-edited-baby-claims-scientists-shocked-global-outcry&quot;&gt;ethical discussion&lt;/a&gt; in the world.&lt;/p&gt;

&lt;p&gt;To what I have learned, this experiment is of dangerous, and we have no idea what has been taken to the world. Our body is full of protein, which has been coded by 3.2 billion bases. The bases and permutation type determined human phenotype, like hair color, weight, and height, etc. Let me explain gene editing with a computer programming project. There is no one in the world can fully comprehend the 3.2 billion codebase line by line. At the same time, our human achieved codebase (Human genome reference sequence), and code editor (CRISPR), someone (Jiankui He) begun to delete two lines of code and initiate the program (give birth of two babies).&lt;/p&gt;

&lt;p&gt;Even in the programming environment, programmers cannot easily modify code without full comprehension of the codebase because bugs are always waiting for us somewhere. Modify before understand will bring the unknown risk for a project, not to mention for human beings.&lt;/p&gt;

&lt;p&gt;Therefore, maybe we need to suspend similar experiments until we have collected enough information to support a deeper comprehension of the human genome.&lt;/p&gt;</content><author><name>Corey</name></author><category term="Science" /><summary type="html">Think twice before acting</summary></entry><entry><title type="html">Why remove drivers while calculating TMB</title><link href="http://localhost:4000/articles/why-remove-drivers-while-calculating-TMB/" rel="alternate" type="text/html" title="Why remove drivers while calculating TMB" /><published>2018-11-22T00:00:00+08:00</published><updated>2018-11-22T00:00:00+08:00</updated><id>http://localhost:4000/articles/why-remove-drivers-while-calculating-TMB</id><content type="html" xml:base="http://localhost:4000/articles/why-remove-drivers-while-calculating-TMB/">&lt;p&gt;Tumor mutational burden (TMB) is a measurement of mutations carried by tumor cells and is a predictive biomarker being studied to evaluate its association with response to Immuno-Oncology (I-O) therapy, such as nivolumab, pembrolizumab, and atezolizumab. We should know that TMB is a measurement of the numbers of mutations carried by tumor cells and the real “secret sauce” in TMB is neoantigens, which is a fraction of the mutations present in the tumor cells will code for proteins that presented on the surface of those cells. These make the immune system more likely to recognize the tumor as foreign.&lt;/p&gt;

&lt;p&gt;To precisely calculate TMB, &lt;a href=&quot;http://www.dslieber.com/&quot;&gt;Daniel Lieber&lt;/a&gt; from FMI has put forward a &lt;a href=&quot;https://cdn2.hubspot.net/hubfs/174278/Corporate%20Landing%20Pages/042017%20-%20AACR%20Landing%20Page/Lieber,%20D%20AACR%202017%20Tumor%20Mutational%20Burden%20Val_.pdf?t=1493408183691&quot;&gt;method&lt;/a&gt;: include removing &lt;code class=&quot;highlighter-rouge&quot;&gt;polymorphisms&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;predicted drivers&lt;/code&gt;, which has almost become the gold standard across NGS industry when counting TMB. The reason for eliminating polymorphisms is because germline variants contribute little to the neoantigens, but there is no doubt that drivers will produce neoantigens, why it is still necessary to remove them?&lt;/p&gt;

&lt;p&gt;At this part, I am trying to answer this question:&lt;/p&gt;

&lt;p&gt;1.Increase TMB value unproperly&lt;/p&gt;

&lt;p&gt;Immunotherapy is a complement choice compared with target therapy. Tumors harboring known drivers (ALK, ROS1, EGFR, BRAF V600E, MET splice) had low TMB (median: 2.5, 3.6, 3.8, 3.8, 4.5)&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; and should not receive immunotherapy. There is a study suggest that immunotherapy is not useful for EGFR-mutant lung cancer&lt;sup id=&quot;fnref:2&quot;&gt;&lt;a href=&quot;#fn:2&quot; class=&quot;footnote&quot;&gt;2&lt;/a&gt;&lt;/sup&gt;. The benefit in OS was realized in patients with EGFR wild-type tumors (HR: 0.67; P &amp;lt; 0.001), but not in patients with EGFR-mutated NSCLC (HR: 1.11; P=0.54). If we take driver mutations into account, it will increase the TMB score and potential direct to immunotherapy by mistake. To avoid the accident, we should remove drivers.&lt;/p&gt;

&lt;p&gt;2.Increase bias&lt;/p&gt;

&lt;p&gt;NGS companies design panels for target hotspots on driver genes, and the TMB score is a by-product from this angle. Therefore, keeping drivers will yield bias while fitting the concordance curve between WES-TMB and Panel-TMB. Regularly, we design a panel for target therapy and including a large number of driver mutations, keeping them when counting TMB will lead to a lower concordance score comparing with removing them.&lt;/p&gt;

&lt;p&gt;By and large, we should remove drivers when counting TMB. I think the reasons I have posted above is of course not the best version, if someone has a better explanation, please leave a comment.&lt;/p&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Schrock A, Sharma N, Peled N, et al. MA14. 01 Updated Dataset Assessing Tumor Mutation Burden (TMB) as a Biomarker for Response to PD-1/PD-L1 Targeted Therapies in Lung Cancer (LC)[J]. Journal of Thoracic Oncology, 2017, 12(1): S422. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
    &lt;li id=&quot;fn:2&quot;&gt;
      &lt;p&gt;Lee C K, Man J, Lord S, et al. Clinical and molecular characteristics associated with survival among patients treated with checkpoint inhibitors for advanced non–small cell lung carcinoma: a systematic review and meta-analysis[J]. JAMA oncology, 2018, 4(2): 210-216. &lt;a href=&quot;#fnref:2&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Corey</name></author><category term="Bioinformatics" /><summary type="html">Secret in TMB algorithm</summary></entry><entry><title type="html">Deduce fetus genotype in NIPD</title><link href="http://localhost:4000/articles/deduce-fetus-genotype-in-NIPD/" rel="alternate" type="text/html" title="Deduce fetus genotype in NIPD" /><published>2018-11-15T00:00:00+08:00</published><updated>2018-11-15T00:00:00+08:00</updated><id>http://localhost:4000/articles/deduce-fetus-genotype-in-NIPD</id><content type="html" xml:base="http://localhost:4000/articles/deduce-fetus-genotype-in-NIPD/">&lt;p&gt;Non-invasive prenatal diagnosis (NIPD) based on the analysis of cell-free fetal DNA (cffDNA) in maternal plasma is now available in clinical practice for a small number of single gene disorders. A key challenge for the development of NIPD is the low level of cffDNA present alongside the high background of maternal cfDNA in maternal plasma. Determine fetus genotype accurately from cffDNA is of great importance for the family’s choice.&lt;/p&gt;

&lt;p&gt;Imagine we have determined the target variant (&lt;strong&gt;aa&lt;/strong&gt;) from a proband patient with autosomal recessive conditions and his/her mother decide to have a second pregnancy. How can we deduce fetus genotype of this target variant from a maternal peripheral blood diagnosis? Here is the thing:&lt;/p&gt;
&lt;ol&gt;
  &lt;li&gt;Draw maternal peripheral blood from pregnant mom&lt;/li&gt;
  &lt;li&gt;Isolate white blood cell (WBC) and plasma from maternal blood&lt;/li&gt;
  &lt;li&gt;Analysis two types of samples by NGS methods&lt;/li&gt;
  &lt;li&gt;Achieve target attributes: frequency in WBC, frequency in plasma and the concentration of cffDNA&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Now, start fetus genotype deducing. The reason behind our deducing method is to compare different plasma theoretical frequencies of three genotypes (AA, A&lt;strong&gt;a&lt;/strong&gt;, &lt;strong&gt;aa&lt;/strong&gt;) to the actual frequency and find the best match. Let’s do this:&lt;/p&gt;

&lt;p&gt;Theoretical scheme:&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Maternal genotype&lt;/th&gt;
      &lt;th&gt;Fetus genotype&lt;/th&gt;
      &lt;th&gt;plasma frequency (fetus_conc: c)&lt;/th&gt;
      &lt;th&gt;plasma frequency (fetus_conc: 5%)&lt;/th&gt;
      &lt;th&gt; &lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;AA&lt;/td&gt;
      &lt;td&gt;AA&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;AA&lt;/td&gt;
      &lt;td&gt;Aa&lt;/td&gt;
      &lt;td&gt;c/2&lt;/td&gt;
      &lt;td&gt;2.5%&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Aa&lt;/td&gt;
      &lt;td&gt;AA&lt;/td&gt;
      &lt;td&gt;(1-c)/2&lt;/td&gt;
      &lt;td&gt;47.5%&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Aa&lt;/td&gt;
      &lt;td&gt;Aa&lt;/td&gt;
      &lt;td&gt;50%&lt;/td&gt;
      &lt;td&gt;50%&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Aa&lt;/td&gt;
      &lt;td&gt;aa&lt;/td&gt;
      &lt;td&gt;(1+c)/2&lt;/td&gt;
      &lt;td&gt;52.5%&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;aa&lt;/td&gt;
      &lt;td&gt;Aa&lt;/td&gt;
      &lt;td&gt;1-c/2&lt;/td&gt;
      &lt;td&gt;97.5%&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;aa&lt;/td&gt;
      &lt;td&gt;aa&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;Assuming parameters:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Frequency in WBC: 47% (A&lt;strong&gt;a&lt;/strong&gt;)&lt;/li&gt;
  &lt;li&gt;Concentration of cffDNA: 10%&lt;/li&gt;
  &lt;li&gt;Frequency in plasma: 41% (A&lt;strong&gt;a&lt;/strong&gt;)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Deducing:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;WBC: a = 47 units, A = 53 units
Plasma: 
1. Maternal: a = 47 units, WBC-frq = 47/100 = 47%
2. plasma-a = actual-a-alleles-in-maternal + theoretical-a-alleles-in-fetus
3. If fetus-AA: plasma-a = 47*0.9+0*0.1, plasma-frq = 42.3/100 = 42.3%
4. If fetus-Aa: plasma-a = 47*0.9+50*0.1, plasma-frq = 47.3/100 = 47.3%
5. If fetus-aa: plasma-a = 47*0.9+100*0.1, plasma-frq = 52.3/100 = 52.3%&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Conclusion:&lt;/p&gt;

&lt;p&gt;Congratulations! The genotype of the fetus is AA, and the mother will yield a healthy baby.&lt;/p&gt;

&lt;p&gt;At the end of this small article, I would like to say that the accuracy of &lt;code class=&quot;highlighter-rouge&quot;&gt;fetal concentration&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;plasma frequency&lt;/code&gt; is crucial for fetal genotype inference. Therefore, it can not be too hard to improve those two metrics.&lt;/p&gt;

&lt;p class=&quot;notice&quot;&gt;&lt;strong&gt;a&lt;/strong&gt;: disease-causing allele&lt;/p&gt;</content><author><name>Corey</name></author><category term="Bioinformatics" /><summary type="html">Explore cffDNA in maternal blood</summary></entry><entry><title type="html">Install Blat on mac with one-liner command</title><link href="http://localhost:4000/articles/install-blat-on-mac-with-one-liner-command/" rel="alternate" type="text/html" title="Install Blat on mac with one-liner command" /><published>2018-11-07T00:00:00+08:00</published><updated>2018-11-07T00:00:00+08:00</updated><id>http://localhost:4000/articles/install-blat-on-mac-with-one-liner-command</id><content type="html" xml:base="http://localhost:4000/articles/install-blat-on-mac-with-one-liner-command/">&lt;p&gt;Blat is a bioinformatics software tool for sequence alignment. When I googled &lt;code class=&quot;highlighter-rouge&quot;&gt;install blat on mac&lt;/code&gt;, what came to my screen are numerous troubleshooting posts. Here, I want to present a one-liner command solution:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;conda &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; bioconda blat  &lt;span class=&quot;c&quot;&gt;# Imagine you already have conda installed&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If do not have conda installed on your Mac, install it with following commands:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget https://repo.continuum.io/miniconda/Miniconda2-latest-MacOSX-x86_64.sh
sh Miniconda2-latest-MacOSX-x86_64.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name>Corey</name></author><category term="Bioinformatics" /><summary type="html">Quick answer</summary></entry><entry><title type="html">Customized color key for pheatmap</title><link href="http://localhost:4000/articles/customized-color-key-for-pheatmap/" rel="alternate" type="text/html" title="Customized color key for pheatmap" /><published>2018-10-31T00:00:00+08:00</published><updated>2018-10-31T00:00:00+08:00</updated><id>http://localhost:4000/articles/customized-color-key-for-pheatmap</id><content type="html" xml:base="http://localhost:4000/articles/customized-color-key-for-pheatmap/">&lt;p&gt;&lt;a href=&quot;https://cran.r-project.org/web/packages/pheatmap/pheatmap.pdf&quot;&gt;Pheatmap&lt;/a&gt; is an R package, which is famous for its heatmap annotation function. Standard color key profile is well-proportioned based on the value of related data frame. If we want to set different split point or uneven color range, what should we do? Here is the code:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-r&quot; data-lang=&quot;r&quot;&gt;&lt;span class=&quot;n&quot;&gt;library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pheatmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set.seed&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;9527&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dat&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cbind&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rnorm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;120&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;120&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;T&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my.breaks&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;seq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;m&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;by&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my.colors&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;-&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colorRampPalette&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;blue&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;white&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my.breaks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colorRampPalette&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;colors&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;white&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;orange&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;red&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;purple&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))(&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;length&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my.breaks&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;m&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pheatmap&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; 
         &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my.colors&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
         &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;breaks&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;n&quot;&gt;my.breaks&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Plus, it should be noticed that we should avoid red-green schema when it is supposed to be shown to someone else. About 8.73% of males and 1.69% of females were found to be color blind&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt; and will have trouble reading red-green heatmap.&lt;/p&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Ahsana S, Hussain R, Fareed M, et al. Prevalence of red-green color vision defects among Muslim males and females of Manipur, India[J]. Iranian journal of public health, 2013, 42(1): 16. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Corey</name></author><category term="Bioinformatics" /><category term="R" /><summary type="html">R snippets</summary></entry><entry><title type="html">Levels of precision medicine product</title><link href="http://localhost:4000/articles/levels-of-precision-medicine-product/" rel="alternate" type="text/html" title="Levels of precision medicine product" /><published>2018-10-01T00:00:00+08:00</published><updated>2018-10-01T00:00:00+08:00</updated><id>http://localhost:4000/articles/levels-of-precision-medicine-product</id><content type="html" xml:base="http://localhost:4000/articles/levels-of-precision-medicine-product/">&lt;p&gt;After more than five years working in precision medicine field, I would like to categorize PM (precision medicine) products into the following five levels. It should be noted that the categorization criteria is based on the most crucial part of every PM products: validation.&lt;/p&gt;

&lt;p&gt;Level 0 is only propaganda without any product yet, not to mention any validation. If an organization releases the flyer pages before the real product comes out, this can be classified into Level 0, and customers can never do a real test with Level 0 PM product.&lt;/p&gt;

&lt;p&gt;Level 1 is in-house simple validation. For Level 1 PM product, it has been tested by simple validation, like simulated-data validation and public-data validation. The difference between Level 0 and Level 1 is that the latter has a real product.&lt;/p&gt;

&lt;p&gt;Level 2 is in-house industry-based standard validation. For Level 2 PM product, it has been validated through consensus standard validation, like Guidelines for Validation of Next-Generation Sequencing-Based Oncology Panels&lt;sup id=&quot;fnref:1&quot;&gt;&lt;a href=&quot;#fn:1&quot; class=&quot;footnote&quot;&gt;1&lt;/a&gt;&lt;/sup&gt;. For Level 2 PM product, it has been under thorough validation, the validation process is good, if the performance (e.g., sensitivity and specificity) is also good, this product can be reliable.&lt;/p&gt;

&lt;p&gt;Level 3 is peer-reviewed validation with a paper published. Unlike Level 1 and 2, Level 3 has been scrutinized by the domain experts rather than just in-house validation. The PM product reach Level 3 is highly recommended, most people would buy it.&lt;/p&gt;

&lt;p&gt;Level X is IVD approval through FDA/CFDA. At this level, the PM product is endorsed by FDA/CFDA, which means the official health system is agreed with the whole validation process. &lt;a href=&quot;https://www.accessdata.fda.gov/cdrh_docs/reviews/DEN170058.pdf&quot;&gt;MSK-IMPACT&lt;/a&gt; and &lt;a href=&quot;https://www.fda.gov/medicaldevices/productsandmedicalprocedures/deviceapprovalsandclearances/recently-approveddevices/ucm590331.htm&quot;&gt;F1CDx&lt;/a&gt; can be categorized into Level X PM product.&lt;/p&gt;

&lt;p&gt;All levels of PM products I have mentioned above exist in the world, especially in China. The reason is that precision medicine is an extremely new field and every company wants to pitch in it. Jack Ma has said that &lt;a href=&quot;http://www.ejinsight.com/20151113-the-new-investment-theme-of-health-and-happiness/&quot;&gt;health and happiness&lt;/a&gt; are promising investing themes. As a typical representation of health, lots of money swarmed into precision medicine, created a large amount of NGS (next-generation sequencing) companies and therefore PM products from Level 0 to Level X co-exist in the market. Even though it is a chaotic situation today, I believe that with FDA/CFDA continuously studying the cutting-edge knowledge, keeping pace with the whole industry, PM products will become increasingly standard and robust. At that day, the organizations which did not hold Level X PM products will soon become incompetent.&lt;/p&gt;

&lt;p&gt;Even though today is not good enough, the future is better than today. Hope every cancer patient could obtain good treatments in the future.&lt;/p&gt;

&lt;div class=&quot;footnotes&quot;&gt;
  &lt;ol&gt;
    &lt;li id=&quot;fn:1&quot;&gt;
      &lt;p&gt;Jennings L J, Arcila M E, Corless C, et al. Guidelines for validation of next-generation sequencing–based oncology panels: a joint consensus recommendation of the Association for Molecular Pathology and College of American Pathologists[J]. The Journal of Molecular Diagnostics, 2017, 19(3): 341-365. &lt;a href=&quot;#fnref:1&quot; class=&quot;reversefootnote&quot;&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;</content><author><name>Corey</name></author><category term="Bioinformatics" /><summary type="html">IVD approval is the key to next round NGS competition</summary></entry><entry><title type="html">How to report</title><link href="http://localhost:4000/articles/how-to-report/" rel="alternate" type="text/html" title="How to report" /><published>2018-09-17T00:00:00+08:00</published><updated>2018-09-17T00:00:00+08:00</updated><id>http://localhost:4000/articles/how-to-report</id><content type="html" xml:base="http://localhost:4000/articles/how-to-report/">&lt;p&gt;In our daily life, we inevitably need to report to others, maybe your boss or a client, even your wife. Reporting is not such a type of work that grabs what you have and throws it to the receiver. To be honest, 70% reports I received are coming to me in this way, and it is very rude. Here, I want to present some practical skills to present a “not-too-rude” report. Even though the report described here will be restricted to sending information to others, not giving a presentation, I think they share the same core value: respect.&lt;/p&gt;

&lt;p&gt;I have been not only reported to my boss but also got reported by my subordinates. According to what I have received, I insist that a good report should follow a “principle of altruism”. In other words, imagine you are the report-receiver, what exactly do you want?&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Send it through Email, not any IM (Instant Message) software.&lt;/li&gt;
  &lt;li&gt;Write a precise and concrete title.&lt;/li&gt;
  &lt;li&gt;Give your conclusion first.&lt;/li&gt;
  &lt;li&gt;Extract solid evidence to support the conclusion.&lt;/li&gt;
  &lt;li&gt;Make the evidence traceable.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In fact, I agree that the project manager can trade between the constraints of &lt;a href=&quot;https://en.wikipedia.org/wiki/Project_management_triangle&quot;&gt;project management triangle&lt;/a&gt;. If the deadline/budget decreases, we can sacrifice our product quality to some extent to complete our task. But if there is an opportunity to improve the task, including delivering a better report, we should keep it.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;The quality of work is constrained by the project’s budget, deadlines and scope (features).&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Delivering a report resembles serving cakes. Somebody throws them at your desk, regardless of whether you have proper tools to eat them. Somebody slices them up and put the slices in a dish. The better way is to slice them up as well as to tell the gourmet what is the chef recommendation and why it is the best choice.&lt;/p&gt;

&lt;p&gt;Everyone is busy, hope we can think more before we send our report.&lt;/p&gt;</content><author><name>Corey</name></author><category term="Life" /><summary type="html">It is a virtue to save others time</summary></entry></feed>